(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"/g8N":function(e,t,a){e.exports={tableList:"web\\pages\\-building\\-device\\-monitor-show\\-list\\index-tableList",tableListOperator:"web\\pages\\-building\\-device\\-monitor-show\\-list\\index-tableListOperator",tableListForm:"web\\pages\\-building\\-device\\-monitor-show\\-list\\index-tableListForm",submitButtons:"web\\pages\\-building\\-device\\-monitor-show\\-list\\index-submitButtons"}},a154:function(e,t,a){"use strict";var n=a("g09b"),o=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l=n(a("bx4M"));a("g9YV");var r=n(a("wCAj"));a("B9cy");var i=n(a("Ol7k"));a("14J3");var d=n(a("BMrR"));a("+L6B");var c=n(a("2/Rp"));a("jCWc");var s=n(a("kPKH"));a("5NDa");var u=n(a("5rEg"));a("ozfa");var f=n(a("MJZm")),h=n(a("qIgq")),m=n(a("p0pE")),p=n(a("2Taf")),w=n(a("vZ4D")),g=n(a("l4Ni")),y=n(a("ujKo")),v=n(a("rlhR")),S=n(a("MhPg"));a("y8nQ");var b,E,R,k,C=n(a("Vl3Y")),F=o(a("q1tI")),K=a("MuoO"),x=n(a("XZXw")),T=n(a("8nCW")),D=a("6LfW"),L=n(a("/g8N")),M=(b=(0,K.connect)(function(e){var t=e.monitorShow,a=e.loading;return{monitorShow:t,loading:a.models.monitorShow}}),E=C.default.create(),b(R=E((k=function(e){function t(){var e,a;(0,p.default)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return a=(0,g.default)(this,(e=(0,y.default)(t)).call.apply(e,[this].concat(o))),a.state={selectedRowKeys:[],selectedRows:[],treeSelectedKeys:[]},a.handleEditClick=function(){var e=a.state.selectedRows;if(0!==e.length){var t=e[0];a.dispatch({type:"monitorShow/loadForm",payload:t,callback:a.handleCallback.bind((0,v.default)(a))})}},a.handleCallback=function(){a.dispatch({type:"monitorShow/changeFormVisible",payload:!0})},a.onTableSelectRow=function(e,t){var n={selectedRowKeys:[],selectedRows:[]};e.length>0&&(n.selectedRowKeys=[e[e.length-1]]),t.length>0&&(n.selectedRows=[t[t.length-1]]),a.setState(n)},a.onTableChange=function(e){a.dispatch({type:"monitorShow/fetchMonitor",pagination:{current:e.current,pageSize:e.pageSize}}),a.clearSelectRows()},a.onResetFormClick=function(){var e=a.props.form;e.resetFields(),a.dispatch({type:"monitorShow/fetchMonitor",search:{position_id:a.getParentID()},pagination:{}})},a.onSearchFormSubmit=function(e){e&&e.preventDefault();var t=a.props.form;t.validateFields(function(e,t){e||(a.dispatch({type:"monitorShow/fetchMonitor",search:(0,m.default)({},t,{position_id:a.getParentID()}),pagination:{}}),a.clearSelectRows())})},a.handleFormCancel=function(){a.dispatch({type:"monitorShow/changeFormVisible",payload:!1})},a.clearSelectRows=function(){var e=a.state.selectedRowKeys;0!==e.length&&a.setState({selectedRowKeys:[],selectedRows:[]})},a.dispatch=function(e){var t=a.props.dispatch;t(e)},a.getParentID=function(){var e=a.state.treeSelectedKeys,t="";if(e.length>0){var n=(0,h.default)(e,1);t=n[0]}return t},a.renderTreeNodes=function(e){return e.map(function(e){return e.children?F.default.createElement(f.default.TreeNode,{title:e.name,key:e.record_id,dataRef:e},a.renderTreeNodes(e.children)):F.default.createElement(f.default.TreeNode,{title:e.name,key:e.record_id,dataRef:e})})},a}return(0,S.default)(t,e),(0,w.default)(t,[{key:"componentDidMount",value:function(){this.dispatch({type:"monitorShow/fetchPositionTree"}),this.dispatch({type:"monitorShow/fetchMonitor",search:{},pagination:{}})}},{key:"renderShow",value:function(){var e=this.props.monitorShow,t=e.formVisible,a=e.formTitle,n=e.formData;return t&&F.default.createElement(T.default,{visible:t,title:a,formData:n,onCancel:this.handleFormCancel})}},{key:"renderSearchForm",value:function(){var e=this.props.form.getFieldDecorator;return F.default.createElement(C.default,{onSubmit:this.onSearchFormSubmit,layout:"inline"},F.default.createElement(d.default,{gutter:8},F.default.createElement(s.default,{span:8},F.default.createElement(C.default.Item,{label:"\u8bbe\u5907\u540d\u79f0"},e("name")(F.default.createElement(u.default,{placeholder:"\u8bf7\u8f93\u5165"})))),F.default.createElement(s.default,{span:6},F.default.createElement("div",{style:{overflow:"hidden"}},F.default.createElement("span",{style:{marginBottom:24}},F.default.createElement(c.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),F.default.createElement(c.default,{style:{marginLeft:8},onClick:this.onResetFormClick},"\u91cd\u7f6e"))))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.monitorShow,o=n.data,d=o.list,s=o.pagination,u=n.treeData,p=n.expandedKeys,w=this.state.selectedRowKeys,g=[{title:"\u8bbe\u5907\u540d\u79f0",dataIndex:"name",width:200},{title:"\u8bbe\u5907\u5382\u5546",dataIndex:"vendor",width:100},{title:"\u8bbe\u5907\u7c7b\u578b",dataIndex:"device_type",width:100,render:function(e){return F.default.createElement(D.DicShow,{pcode:"OPER$#monitor_category",code:[e],show:function(e){return e}})}},{title:"\u8bbe\u5907\u7f16\u53f7",dataIndex:"device_code"}],y=(0,m.default)({showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e){return F.default.createElement("span",null,"\u5171",e,"\u6761")}},s);return F.default.createElement(x.default,{title:"\u89c6\u9891\u76d1\u63a7\u5c55\u793a"},F.default.createElement(i.default,null,F.default.createElement(i.default.Sider,{width:200,style:{background:"#fff",borderRight:"1px solid lightGray"}},F.default.createElement(f.default,{expandedKeys:p,onSelect:function(t){e.setState({treeSelectedKeys:t});var a=e.props.monitorShow.search,n={position_id:""};if(t.length>0){var o=(0,h.default)(t,1);n.position_id=o[0]}e.dispatch({type:"monitorShow/fetchMonitor",search:(0,m.default)({},a,n),pagination:{}}),e.clearSelectRows()},onExpand:function(t){e.dispatch({type:"monitorShow/saveExpandedKeys",payload:t})}},this.renderTreeNodes(u))),F.default.createElement(i.default.Content,null,F.default.createElement(l.default,{bordered:!1},F.default.createElement("div",{className:L.default.tableList},F.default.createElement("div",{className:L.default.tableListForm},this.renderSearchForm()),F.default.createElement("div",{className:L.default.tableListOperator},1===w.length&&[F.default.createElement(c.default,{key:"edit",icon:"eye",type:"primary",onClick:function(){return e.handleEditClick()}},"\u67e5\u770b\u5b9e\u65f6\u76d1\u63a7")]),F.default.createElement(r.default,{rowSelection:{selectedRowKeys:w,onChange:this.onTableSelectRow},loading:a,rowKey:function(e){return e.record_id},dataSource:d,columns:g,pagination:y,onChange:this.onTableChange,size:"small"}))))),this.renderShow())}}]),t}(F.PureComponent),R=k))||R)||R),N=M;t.default=N}}]);