(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{hP1q:function(e,t,i){"use strict";var a=i("tAuX"),n=i("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("2qtc");var l=n(i("kLXV")),o=n(i("gWZ8")),s=n(i("2Taf")),r=n(i("vZ4D")),d=n(i("l4Ni")),c=n(i("ujKo")),f=n(i("MhPg")),p=a(i("q1tI")),m=a(i("Womt")),h=i("RyHr"),u=i("5kJi"),g=i("QIYC"),A=i("DBIF"),w=i("IQkn"),y=n(i("s1sE")),v=n(i("qdPp"));function b(e){return p.default.createElement("div",{className:v.default.siderButton,onClick:e.onClick},p.default.createElement("img",{src:e.open?"/assets/sider-btn-close.png":"/assets/sider-btn-open.png",alt:""}),p.default.createElement("span",null,"\u6570\u636e\u5c55\u793a"))}var S=function(e){function t(){var e,i;(0,s.default)(this,t);for(var a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];return i=(0,d.default)(this,(e=(0,c.default)(t)).call.apply(e,[this].concat(n))),i.state={chartVisible:!1,data:[{name:"A1-1",flag:1,type:-1,position:[-22500,14e3,-17e3],file:"A14"},{name:"A1-2",flag:1,type:1,position:[-23e3,12e3,-1e4],file:"A9"},{name:"A1-3",flag:1,type:1,position:[-29500,15e3,-17e3],file:"A11"},{name:"A1-4",flag:1,type:1,position:[-29500,12e3,-10500],file:"A8"},{name:"A1-5",flag:1,type:1,position:[-37500,17e3,-13e3],file:"A10"},{name:"A2-1",flag:1,type:0,position:[-21500,12500,0],file:"A7"},{name:"A2-2",flag:1,type:0,position:[-20500,11500,9e3],file:"A12"},{name:"A2-3",flag:1,type:0,position:[-27500,11500,0],file:"A1"},{name:"A2-4",flag:1,type:0,position:[-27500,11500,1e4],file:"A6"},{name:"A2-5",flag:1,type:1,position:[-35500,13500,0],file:"A0"},{name:"A2-6",flag:1,type:1,position:[-35500,12500,1e4],file:"A5"},{name:"A3-1",flag:1,type:0,position:[-21500,12e3,19e3],file:"A13"},{name:"A3-2",flag:1,type:1,position:[-20500,9e3,28e3],file:"A3"},{name:"A3-3",flag:1,type:1,position:[-26500,11e3,27e3],file:"A15"},{name:"A3-4",flag:1,type:0,position:[-35500,12e3,19e3],file:"A4"},{name:"A3-5",flag:1,type:0,position:[-34e3,2e4,28e3],file:"A2"},{name:"A4-1",flag:1,type:1,position:[12500,12e3,-17e3],file:"A22"},{name:"A4-2",flag:1,type:-1,position:[6500,12e3,-18e3],file:"A34"},{name:"A4-3",flag:1,type:1,position:[5500,16e3,-9e3],file:"A18"},{name:"A4-4",flag:1,type:1,position:[-5500,16e3,-9e3],file:"A17"},{name:"A4-5",flag:1,type:1,position:[-5500,12e3,-17e3],file:"A23"},{name:"A4-6",flag:1,type:1,position:[-13e3,13e3,-17500],file:"A37"},{name:"A5-1",flag:1,type:-1,position:[10500,17e3,1e3],file:"A19"},{name:"A5-2",flag:1,type:0,position:[6500,17e3,1e4],file:"A21"},{name:"A5-3",flag:1,type:1,position:[500,34e3,1e3],file:"A24"},{name:"A5-4",flag:1,type:-1,position:[-7500,17e3,1e4],file:"A20"},{name:"A5-5",flag:1,type:-1,position:[-12e3,17e3,1e3],file:"A16"},{name:"A6-1",flag:1,type:1,position:[37e3,16e3,-1e4],file:"A35"},{name:"A6-2",flag:1,type:1,position:[29500,14e3,-1e4],file:"A25"},{name:"A6-3",flag:1,type:1,position:[29500,14e3,-17e3],file:"A28"},{name:"A6-4",flag:1,type:1,position:[22500,14e3,-1e4],file:"A26"},{name:"A6-5",flag:1,type:-1,position:[22500,14e3,-17e3],file:"A27"},{name:"A7-1",flag:1,type:1,position:[37500,12500,1e3],file:"A32"},{name:"A7-2",flag:1,type:1,position:[37500,12500,1e4],file:"A31"},{name:"A7-3",flag:1,type:1,position:[29500,12500,1e4],file:"A33"},{name:"A7-4",flag:1,type:-1,position:[29500,12500,1e3],file:"A40"},{name:"A7-5",flag:1,type:1,position:[22500,12500,1e4],file:"A29"},{name:"A7-6",flag:1,type:-1,position:[22500,12500,1e3],file:"A30"},{name:"A8-1",flag:1,type:1,position:[37500,17e3,27500],file:"A38"},{name:"B0",file:"B0"},{name:"B1",file:"B1"},{name:"B2",file:"B2"},{name:"B3",file:"B3"},{name:"B4",file:"B4"}]},i.loadObject=function(e){(new g.MTLLoader).load("/models/".concat(e.file,".mtl"),function(t){t.preload();var a=new u.OBJLoader;a.setMaterials(t),a.load("/models/".concat(e.file,".obj"),function(t){t.position.x=i.opts.modelPosition[0]*i.opts.modelScale,t.position.y=i.opts.modelPosition[1]*i.opts.modelScale,t.position.z=i.opts.modelPosition[2]*i.opts.modelScale,t.scale.set(i.opts.modelScale,i.opts.modelScale,i.opts.modelScale),1===e.flag&&i.addObjectFlag(e,t),i.scene.add(t)})})},i.addObjectFlag=function(e,t){var a,n=document.createElement("canvas");n.width=90,n.height=57;var l=new m.Texture(n),s=n.getContext("2d"),r=new Image;switch(e.type){case 1:r.src="/models/green.png";break;case-1:r.src="/models/red.png";break;default:r.src="/models/yellow.png";break}r.onload=function(){s.drawImage(r,0,0),s.fillStyle="#ffffff",s.font="30px Arial",s.lineWidth=5,s.textAlign="center",s.fillText(e.name,45,32),l.needsUpdate=!0};var d=new m.SpriteMaterial({map:l}),c=new m.Sprite(d);c.scale.set(2e3,2e3,2e3),(a=c.position).set.apply(a,(0,o.default)(e.position)),t.add(c),t.on("mouseover",function(e){var t=!0,a=!1,n=void 0;try{for(var l,o=i.objects[Symbol.iterator]();!(t=(l=o.next()).done);t=!0){var s=l.value;s instanceof m.Mesh&&i.effect.deselectObject(s)}}catch(e){a=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}var r=e.data.target;if(r instanceof m.Group){var d=!0,c=!1,f=void 0;try{for(var p,h=r.children[Symbol.iterator]();!(d=(p=h.next()).done);d=!0){var u=p.value;u instanceof m.Mesh&&i.effect.selectObject(u)}}catch(e){c=!0,f=e}finally{try{d||null==h.return||h.return()}finally{if(c)throw f}}}else r instanceof m.Mesh&&i.effect.selectObject(r)}),t.on("mouseout",function(e){var t=e.data.target;if(t instanceof m.Group){var a=!0,n=!1,l=void 0;try{for(var o,s=t.children[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var r=o.value;r instanceof m.Mesh&&i.effect.deselectObject(r)}}catch(e){n=!0,l=e}finally{try{a||null==s.return||s.return()}finally{if(n)throw l}}}else t instanceof m.Mesh&&i.effect.deselectObject(t)}),t.on("click",function(){});var f=t.children;i.objects=[].concat((0,o.default)(i.objects),(0,o.default)(f))},i.handleModalCancel=function(){i.setState({chartVisible:!1})},i.handleResize=function(){i.camera.aspect=i.opts.width/i.opts.height,i.camera.updateProjectionMatrix(),i.renderer.setSize(i.opts.width,i.opts.height)},i.start=function(){i.frameId||(i.frameId=window.requestAnimationFrame(i.animate))},i.stop=function(){window.cancelAnimationFrame(i.frameId)},i.animate=function(){i.composer.render(),i.frameId=window.requestAnimationFrame(i.animate)},i.handleSiderClick=function(){var e=i.state.chartVisible;i.setState({chartVisible:!e})},i}return(0,f.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e,t,i=this;this.opts={width:this.mount.clientWidth,height:this.mount.clientHeight,cameraAngle:45,cameraPosition:[0,77534,-101173],minDistance:5e4,maxDistance:3e5,lightColor:14540253,lightIntensity:.5,lightPosition:[1e5,1e5,1e5],sceneBg:"/models/dark-bg.png",modelPosition:[-2e4,160,-1771],modelScale:1},this.scene=new m.Scene,this.camera=new m.PerspectiveCamera(this.opts.cameraAngle,this.opts.width/this.opts.height,1,2*this.opts.maxDistance),(e=this.camera.position).set.apply(e,(0,o.default)(this.opts.cameraPosition)),this.scene.add(this.camera),this.renderer=new m.WebGLRenderer({antialias:!0,alpha:!0,logarithmicDepthBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.opts.width,this.opts.height),this.mount.appendChild(this.renderer.domElement),this.composer=new A.EffectComposer(this.renderer);var a=new A.OutlineEffect(this.scene,this.camera,{blendFunction:A.BlendFunction.SCREEN,edgeStrength:2.5,pulseSpeed:0,visibleEdgeColor:16777215,blur:!1,xRay:!0});this.composer.addPass(new A.RenderPass(this.scene,this.camera));var n=new A.EffectPass(this.camera,a);n.renderToScreen=!0,this.composer.addPass(n),this.effect=a;var l=new m.AmbientLight("0xcccccc",1);this.scene.add(l);var s=new h.OrbitControls(this.camera,this.renderer.domElement);s.maxPolarAngle=.48*Math.PI,s.minDistance=this.opts.minDistance,s.maxDistance=this.opts.maxDistance;var r=new m.SpotLight(this.opts.lightColor,this.opts.lightIntensity);(t=r.position).set.apply(t,(0,o.default)(this.opts.lightPosition)),this.camera.add(r),this.scene.background=(new m.TextureLoader).load(this.opts.sceneBg),this.interaction=new w.Interaction(this.renderer,this.scene,this.camera),window.addEventListener("resize",this.handleResize,!1),this.start(),this.objects=[],this.loadObject({name:"LU",file:"LU"});var d=this.state.data;d.forEach(function(e){i.loadObject(e)})}},{key:"componentWillUnmount",value:function(){this.stop(),window.removeEventListener("resize",this.handleResize),this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this,t=this.state.chartVisible;return p.default.createElement("div",{className:v.default.main,ref:function(t){e.mount=t}},!t&&p.default.createElement("div",{className:v.default.closeSider},p.default.createElement("div",{className:v.default.closeSiderLeft}),p.default.createElement("div",{className:v.default.closeSiderRight},p.default.createElement(b,{open:t,onClick:this.handleSiderClick}))),p.default.createElement("ul",{className:v.default.topFlag},p.default.createElement("li",null,p.default.createElement("span",null,"\u5df2\u62db\u5546")),p.default.createElement("li",null,p.default.createElement("span",null,"\u672a\u62db\u5546")),p.default.createElement("li",null,p.default.createElement("span",{onClick:this.handleSiderClick},"\u90e8\u5206\u62db\u5546"))),t&&p.default.createElement(l.default,{destroyOnClose:!0,visible:t,className:v.default.darkModal,maskClosable:!1,closable:!0,width:"68%",centered:!0,maskStyle:{background:"transparent"},onCancel:function(){e.handleModalCancel()},footer:null},p.default.createElement(y.default,{show:t})))}}]),t}(p.PureComponent),k=S;t.default=k},qdPp:function(e,t,i){e.exports={main:"web\\pages\\-building\\-park-view\\index-main",topFlag:"web\\pages\\-building\\-park-view\\index-topFlag",closeSider:"web\\pages\\-building\\-park-view\\index-closeSider",closeSiderLeft:"web\\pages\\-building\\-park-view\\index-closeSiderLeft",closeSiderRight:"web\\pages\\-building\\-park-view\\index-closeSiderRight",siderButton:"web\\pages\\-building\\-park-view\\index-siderButton",siderDrawer:"web\\pages\\-building\\-park-view\\index-siderDrawer",openSider:"web\\pages\\-building\\-park-view\\index-openSider",openSiderLeft:"web\\pages\\-building\\-park-view\\index-openSiderLeft",openSiderRight:"web\\pages\\-building\\-park-view\\index-openSiderRight",darkModal:"web\\pages\\-building\\-park-view\\index-darkModal"}}}]);