(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[67],{"9GTg":function(e,t,n){"use strict";var a=n("g09b"),o=n("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("IzEo");var r=a(n("bx4M"));n("+L6B");var c=a(n("2/Rp"));n("2qtc");var l=a(n("kLXV")),u=a(n("2Taf")),i=a(n("vZ4D")),s=a(n("l4Ni")),d=a(n("ujKo")),p=a(n("rlhR")),f=a(n("MhPg"));n("y8nQ");var m,h,k,g,C=a(n("Vl3Y")),y=o(n("q1tI")),D=n("MuoO"),I=a(n("XZXw")),T=n("+n12"),S=n("riZX"),v=a(n("LeT2")),M=a(n("F6yL")),w=n("4QLA"),x=(m=(0,D.connect)(function(e){return{columnManage:e.columnManage,loading:e.loading.models.columnManage}}),h=C.default.create(),m(k=h((g=function(e){function t(){var e,n;(0,u.default)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return n=(0,s.default)(this,(e=(0,d.default)(t)).call.apply(e,[this].concat(o))),n.state={dataFormID:"",step:-1,dataDetail:!1,dataColumnID:""},n.onOrgChange=function(e){n.setState({value:e.target.value}),n.props.dispatch({type:"columnManage/queryColumnTree",org:e.target.value})},n.onTableChange=function(e){n.props.dispatch({type:"columnManage/fetch",pagination:{current:e.current,pageSize:e.pageSize}})},n.onResetFormClick=function(){n.props.form.resetFields(),n.props.dispatch({type:"columnManage/saveSearch",payload:{}}),n.refreshTree(),n.props.dispatch({type:"columnManage/fetch"})},n.onTableChange=function(e){n.props.dispatch({type:"columnManage/fetch",pagination:{current:e.current,pageSize:e.pageSize}})},n.onSearchFormSubmit=function(e){n.props.dispatch({type:"columnManage/fetch",payload:e})},n.onDataFormCallback=function(e){e&&"ok"===e&&(n.props.dispatch({type:"columnManage/fetch"}),n.refreshTree()),n.showStep(-1)},n.onDataDetailCallback=function(){n.setState({dataDetail:!1,dataColumnID:"",step:-1})},n.onItemDetailClick=function(e){n.setState({dataDetail:!0,dataColumnID:e})},n.onAddClick=function(){n.setState({dataFormID:""},function(){n.showStep(0)})},n.onItemDescClick=function(e){n.setState({dataFormID:e},function(){n.showStep(0)})},n.onItemCtrlClick=function(e){n.setState({dataFormID:e},function(){n.showStep(1)})},n.onItemExtraClick=function(e){n.setState({dataFormID:e},function(){n.showStep(2)})},n.onDelOKClick=function(e){n.props.dispatch({type:"columnManage/del",payload:e}),n.refreshTree()},n.onItemDeleteClick=function(e){l.default.confirm({title:"\u786e\u5b9a\u5220\u9664\u8be5\u6570\u636e\u5417\uff1f",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:n.onDelOKClick.bind((0,p.default)(n),e)})},n.onItemLockClick=function(e){l.default.confirm({title:"\u786e\u5b9a\u9501\u5b9a\u8be5\u680f\u76ee\u5417\uff1f",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){n.props.dispatch({type:"columnManage/lock",payload:e}),n.refreshTree()}})},n.onItemUnLockClick=function(e){l.default.confirm({title:"\u786e\u5b9a\u89e3\u9501\u8be5\u680f\u76ee\u5417\uff1f",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){n.props.dispatch({type:"columnManage/unlock",payload:e}),n.refreshTree()}})},n.onItemRecoverClick=function(e){l.default.confirm({title:"\u786e\u5b9a\u8981\u6062\u590d\u680f\u76ee\u5417\uff1f",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){n.props.dispatch({type:"columnManage/recover",payload:e}),n.refreshTree()}})},n.onItemDestroyClick=function(e){l.default.confirm({title:"\u786e\u5b9a\u5f7b\u5e95\u5220\u9664\u8be5\u680f\u76ee\u5417\uff1f\u5f7b\u5e95\u5220\u9664\u540e\u4e0d\u80fd\u6062\u590d\u3002",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){n.props.dispatch({type:"columnManage/destroy",payload:e}),n.refreshTree()}})},n.showStep=function(e){n.setState({step:e})},n.refreshTree=function(){n.props.dispatch({type:"columnManage/queryColumnTree",org:n.state.value})},n.creOps=function(e){var t=[];return 0===e.status.status&&t.push({icon:"edit",name:"\u4fee\u6539\u63cf\u8ff0",handler:function(){return n.onItemDescClick(e.column_id)}}),0===e.status.status&&t.push({icon:"edit",name:"\u63a7\u5236\u53c2\u6570",handler:function(){return n.onItemCtrlClick(e.column_id)}}),0===e.status.status&&t.push({icon:"edit",name:"\u6269\u5c55\u5c5e\u6027",handler:function(){return n.onItemExtraClick(e.column_id)}}),0===e.status.status&&t.push({icon:"delete",name:"\u5220\u9664",handler:function(){return n.onItemDeleteClick(e.column_id)}}),0===e.status.status&&t.push({icon:"lock",name:"\u9501\u5b9a",handler:function(){return n.onItemLockClick(e.column_id)}}),1===e.status.status&&t.push({icon:"unlock",name:"\u89e3\u9501",handler:function(){return n.onItemUnLockClick(e.column_id)}}),-1===e.status.status&&t.push({icon:"reload",name:"\u6062\u590d",handler:function(){return n.onItemRecoverClick(e.column_id)}}),-1===e.status.status&&t.push({icon:"close",name:"\u5f7b\u5e95\u5220\u9664",handler:function(){return n.onItemDestroyClick(e.column_id)}}),t},n.renderDataForm=function(){if(n.state.step>-1)return y.default.createElement(S.ColumnEdit,{columnId:n.state.dataFormID,step:n.state.step,callback:n.onDataFormCallback})},n.renderDataDetail=function(){if(n.state.dataDetail)return y.default.createElement(S.ColumnCard,{id:n.state.dataColumnID,callback:n.onDataDetailCallback,visible:!0})},n}return(0,f.default)(t,e),(0,i.default)(t,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"columnManage/saveSearch",payload:{status:[0,1]}}),this.props.dispatch({type:"columnManage/fetch"}),this.refreshTree()}},{key:"render",value:function(){var e=this,t=this.props,n=t.loading,a=t.columnManage.data,o=a.list,l=a.pagination,u=[{title:"\u680f\u76ee\u540d\u79f0",dataIndex:"desc.name",width:150},{title:"\u77ed\u540d\u79f0",dataIndex:"desc.short_name",width:100},{title:"\u72b6\u6001",dataIndex:"status.status",render:function(e){return y.default.createElement(S.ColumnStatus,{code:e})}},{title:"\u6240\u5c5e\u7ec4\u7ec7",dataIndex:"desc.org",width:150,render:function(e){return y.default.createElement(w.OrgShow,{value:e})}},{title:"\u680f\u76ee\u7c7b\u578b",dataIndex:"desc.kind",width:100,render:function(e){var t="";return 0===e&&(t="\u4e00\u822c\u680f\u76ee"),1===e&&(t="\u7cfb\u7edf\u680f\u76ee"),2===e&&(t="\u4e13\u9898\u680f\u76ee"),3===e&&(t="\u4ea4\u6d41\u4e92\u52a8"),y.default.createElement("span",null,t)}},{title:"\u521b\u5efa\u7528\u6237",dataIndex:"operator.creator",width:100,render:function(e){return y.default.createElement(M.default,{uid:e})}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"operator.cre_time",width:200,render:function(e){return y.default.createElement("span",null,(0,T.parseUtcTime)(e))}}];return y.default.createElement(I.default,{title:"\u680f\u76ee\u7ba1\u7406"},y.default.createElement(r.default,{bordered:!1},y.default.createElement(S.ColumnSearch,{onSearch:this.onSearchFormSubmit}),y.default.createElement(v.default,{loading:n,ops:this.creOps,title:function(){return y.default.createElement(c.default,{icon:"plus",type:"primary",onClick:function(){return e.onAddClick()}},"\u65b0\u5efa")},rowKey:function(e){return e.column_id},dataSource:o,columns:u,pagination:l,onChange:this.onTableChange,scroll:{x:1e3},onRow:function(t){return{onClick:function(){e.onItemDetailClick(t.column_id)}}}})),this.renderDataForm(),this.renderDataDetail())}}]),t}(y.PureComponent),k=g))||k)||k);t.default=x}}]);